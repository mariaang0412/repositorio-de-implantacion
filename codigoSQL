CREATE DATABASE GESTION_CITAS
GO

USE GESTION_CITAS
GO

CREATE TABLE PACIENTES
(	
	CEDULA CHAR (8) PRIMARY KEY,
	NOMBRES VARCHAR (30),
	APELLIDOS VARCHAR (30),
	DIRECCION VARCHAR (30),
	TELEFONO VARCHAR (30),
);

CREATE TABLE ESPECIALIDADES
(
	ID INT IDENTITY(1, 1) PRIMARY KEY, 
	NOMBRE  VARCHAR(40)
);

CREATE TABLE MÃ‰DICOS
(
	ID INT IDENTITY(1, 1) PRIMARY KEY,
	CEDULA CHAR(8),
	NOMBRES VARCHAR(30)
	APELLIDOS VARCHAR(30)
	ESPECIALIDAD_ID INT,
	FOREIGN KEY (ESPECIALIDAD_ID) REFERENCES ESPECIALIDADADES (ID)
);


CREATE TABLE HORARIOS
(
	ID INT IDENTITY(1, 1) PRIMARY KEY,
	HORA_INICIO TIME NOT NULL,
	HORA_FIN TIME NOT NULL,
	CUPOS INT CHECK(CUPOS>=1) NOT NULL
);
CREATE TABLE DIAS
(
	DIA CHAR(1),
	MEDICO_ID INT,
	FOREIGN KEY (MEDICO_ID) REFERENCES MEDICOS(ID),

	HORARIO_ID INT,
	FOREIGN KEY (HORARIO_ID) REFERENCES HORARIOS(ID),

	PRIMARY KEY (DIA, MEDICO_ID)
);

CREATE TABLE CITAS
(
	ID INT IDENTITY(1, 1) PRIMARY KEY,

	PACIENTE_CEDULA CHAR(8) NOT NULL,
	FOREIGN KEY (PACIENTES_CEDULA) REFERENCES PACIENTES(CEDULA),
	
	MEDICO_ID INT NOT NULL
	FOREIGN KEY (MEDICO_ID) REFERENCES MEDICOS(ID),

	URGENCIA BIT DEFAULT 0, -- 1: CITA URGENTE | 0: NORMAL
	FECHA_PROGRAMADA DATETIME NOT NULL,
	FECHA_REGISTRO DATETIME DEFAULT GETDATE(),
	NUMERO_ORDEN INT CHECK (NUMERO_ORDEN>=1)
); 
